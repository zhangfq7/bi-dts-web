define(["bace","view/box","view/component/reportUtil","view/widgets/plugins/echarts/tpl"],function(d,a,b,e){var c={};c.control={};c.view={startAnalysis:function(){},saveReport:function(f){var g=true;if(a.Property.close&&a.Property.close()===false){return}if($("#tableChartPanel .container").length==0){$.dialog({lock:true,content:'<div style="color:#444;font-weight:bolder;margin-top:-10px">请从图表区域选择有效的图形报表！</div>',icon:"warning",ok:true});return}$("#tableChartPanel .container").each(function(){var i=$(this);var h=i.data("option");if(h===undefined||h.isInit===false){$("#tableChartPanel").animate({scrollTop:i.css("top")},500);$.dialog({lock:true,content:'<div style="color:#444;font-weight:bolder;margin-top:-10px">该报表不可用，请添加有效的指标维度或移除，再继续保存！</div>',icon:"warning",ok:true});g=false;return false}});if(f&&g){f();return}if(g){b.show()}},publishReport:function(){c.view.saveReport(function(){var f=a.Widgets.start("collect");var h={reportId:a.main.reportId||"",dataId:a.main.dataId,reportName:"预览",reportDesc:"",labelId:"",resportConfig:$.toJSON(f),thumbURL:""};var g=(new Date()).getTime();window.sessionStorage.setItem(g,$.toJSON(h));window.open(d.handleUrlParam("/platform/dataview/view")+"?previewKey="+g)})},saveLayout:function(){e.show(null,"save")},importLayout:function(){e.show(null,"import")}};c.model={configData:{id:"tabs_start",groups:[{title:"任务面板",tools:[{id:"saveReport",text:"保存",iconCls:"icon-start-saveReport",click:c.view.saveReport},{id:"publishReport",text:"预览报表",iconCls:"icon-start-publishReport",click:c.view.publishReport}]},{title:"布局管理",tools:[{id:"saveLayout",text:"保存模版",iconCls:"icon-start-saveLayout",click:c.view.saveLayout},{id:"importLayout",text:"引用模版",iconCls:"icon-start-importLayout",click:c.view.importLayout}]}]}};return{saveReport:c.view.saveReport,config:c.model.configData,changeLayoutManage:function(){c.model.configData.groups.pop();c.model.configData.groups[0].tools.pop();c.model.configData.groups[0].tools[0].text="另存为";c.model.configData.groups[0].tools[0].iconCls="icon-discovery-saveReport"}}});