define(["bace","view/box","view/component/reportUtil","view/widgets/plugins/echarts/tpl"],function(c,a,b,e){var d={};d.control={};d.view={saveReport:function(f){var g=true;if(a.Property.close&&a.Property.close()===false){return}if($("#tableChartPanel .container").length==0){$.dialog({lock:true,content:'<div style="color:#444;font-weight:bolder;margin-top:-10px">请从图表区域选择有效的图形仪表板！</div>',icon:"warning",ok:true});return}$("#tableChartPanel .container").each(function(){var i=$(this);var h=i.data("option");if(h===undefined||h.isInit===false){$("#tableChartPanel").animate({scrollTop:i.css("top")},500);$.dialog({lock:true,content:'<div style="color:#444;font-weight:bolder;margin-top:-10px">该仪表板不可用，请添加有效的指标维度或移除，再继续保存！</div>',icon:"warning",ok:true});g=false;return false}});if(f&&g){f();return}if(g){b.show()}},publishReport:function(){d.view.saveReport(function(){var f=a.Widgets.start("collect");var h={reportId:a.main.reportId||"",dataId:a.main.dataId,reportName:"预览",reportDesc:"",labelId:"",resportConfig:$.toJSON(f),thumbURL:"",urlMenuInfo:$.toJSON(a.main.urlMenuInfo),};var g=(new Date()).getTime();window.sessionStorage.setItem(g,$.toJSON(h));window.open(c.handleUrlParam("/platform/dataview/view")+"?previewKey="+g)})}};d.model={configData:{id:"tabs_preview",groups:[{tools:[{id:"publishReport",text:"预览仪表板",iconCls:"icon-start-publishReport",click:d.view.publishReport}]}]}};return{saveReport:d.view.saveReport,config:d.model.configData,changeLayoutManage:function(){d.model.configData.groups[0].tools.pop();d.model.configData.groups[0].tools[0].text="另存为";d.model.configData.groups[0].tools[0].iconCls="icon-discovery-saveReport"}}});