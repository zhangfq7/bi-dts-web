define(["bace","view/box","view/component/reportUtil","view/widgets/plugins/echarts/tpl"],function(d,a,c,e){var b={};b.control={};b.view={saveReport:function(f){var g=true;if(a.Property.close&&a.Property.close()===false){return}if($("#tableChartPanel .container").length==0){$.dialog({lock:true,content:'<div style="color:#444;font-weight:bolder;margin-top:-10px">请从图表区域选择有效的图形仪表板！</div>',icon:"warning",ok:true});return}$("#tableChartPanel .container").each(function(){var i=$(this);var h=i.data("option");if(h===undefined||h.isInit===false){$("#tableChartPanel").animate({scrollTop:i.css("top")},500);$.dialog({lock:true,content:'<div style="color:#444;font-weight:bolder;margin-top:-10px">该仪表板不可用，请添加有效的指标维度或移除，再继续保存！</div>',icon:"warning",ok:true});g=false;return false}});if(f&&g){f();return}if(g){c.show()}},publishReport:function(){b.view.saveReport(function(){var f=a.Widgets.start("collect");var h={reportId:a.main.reportId||"",dataId:a.main.dataId,reportName:"预览",reportDesc:"",labelId:"",resportConfig:$.toJSON(f),thumbURL:""};var g=(new Date()).getTime();window.sessionStorage.setItem(g,$.toJSON(h));window.open(d.handleUrlParam("/platform/dataview/view")+"?previewKey="+g)})},saveLayout:function(){e.show(null,"save")},};b.model={configData:{id:"tabs_save",groups:[{title:"任务面板",tools:[{id:"saveReport",text:"保存为仪表板",iconCls:"icon-start-saveReport",click:b.view.saveReport},{id:"saveLayout",text:"保存为模版",iconCls:"icon-start-saveLayout",click:b.view.saveLayout}]}]}};return{saveReport:b.view.saveReport,config:b.model.configData,changeLayoutManage:function(){b.model.configData.groups[0].tools.pop();b.model.configData.groups[0].tools[0].text="另存为";b.model.configData.groups[0].tools[0].iconCls="icon-discovery-saveReport"}}});