define(["bace","view/box","underscore","chosen"],function(d,a,b){var c={};c.control={init:function(f,e){c.view.rander(f,e)},collect:function(f){f=f||"query";var e=$(".filter-panel .input_cell","#filterPanel");var g=e.map(function(i){var j=$(this);if(j.find(".textinputer")[0]){var h=j.find(".textinputer");return{paramRuleType:h.data("ruletype"),paramName:h.attr("name"),paramCode:h.attr("id"),paramRuleData:h.val(),paramType:h.data("paramtype"),isDes:h.data("isdes")}}else{var h=j.find("select");return{paramRuleType:h.data("ruletype"),paramName:h.attr("name"),paramCode:h.attr("id"),paramRuleData:(h.val()||[]).join("||"),paramType:h.data("paramtype"),isDes:h.data("isdes")}}})||[];switch(f){case"query":return JSON.stringify([].slice.call(g));break;case"exec":return"";break;default:return""}}};c.view={rander:function(i,g){var f=$(".filter-panel","#filterPanel");f.empty();var h=0;var k=b.map(i,function(n,m){console.log(n);var l=null;var p=n.paramRuleType;if(p=="1"){l='<input type="text" class="textinputer" data-ruletype="{{paramRuleType}}" data-paramtype="{{paramType}}" data-isdes="{{isDes}}" name="{{paramName}}" id="{{paramCode}}" value="'+(new Date()).format(n.paramRuleData)+'" disabled />'}else{if(p=="2"){h+=1;l='<select style="width:100%" multiple name="{{paramName}}" data-ruletype="{{paramRuleType}}" data-paramtype="{{paramType}}" data-isdes="{{isDes}}" id="{{paramCode}}" class="dim-select'+h+'" data-placeholder="请选择维度"></select>'}else{l='<input type="text" class="textinputer" data-ruletype="{{paramRuleType}}" data-paramtype="{{paramType}}" data-isdes="{{isDes}}" name="{{paramName}}"  id="{{paramCode}}" />'}}var o="<div class='filter_can'><div class='label_cell'><label class='filter_name' title='{{paramName}}'>{{paramName}}({{paramCode}}) :</label></div><div class='input_cell'>"+l+"</div></div>";return d.buildString(o,n)});f.html(k.join(""));if(h>0){for(var j=1;j<=h;j++){jQuery(".dim-select"+j,"#filterPanel").chosen({disable_search:false});var e=jQuery(".dim-select"+j,"#filterPanel").attr("id");jQuery(".dim-select"+j,"#filterPanel").ajaxChosen({fields:["code","value"],findPage:true,disabled:false,url:d.handleUrlParam("/platform/openapi/query-dim-info")+"?paramCode="+e+"&paramInfoStr="+JSON.stringify(i)+"&apiBaseInfoStr="+JSON.stringify(g)+"&_t="+(new Date()).getTime()})}}window.myLayout.resizeAll()},bindEvents:function(){}};return c.control});