define(["bace","view/layout","view/pc/contanier","view/pc/serach","view/box","view/pc/share","layout","poshytip","grid","date","switchButton","dialog","colpick","chosen","ztree","placeholder","dotdotdot","validation"],function(d,c,e,f,b,a){goal=JSON.parse(sessionStorage.goal);sessionStorage.removeItem("goal");var g={};g.control={init:function(){h(JSON.parse(goal.goalChoose));function h(l){for(var m=0;m<l.length;m++){$("#themeHead").append("<li code="+l[m].reportId+">"+l[m].reportName+"</li>")}$("#themeHead li:first").addClass("chooseTheme")}$("#themeHead").on("click","li",function(){if(!$(this).hasClass("chooseTheme")){$(this).addClass("chooseTheme").siblings().removeClass("chooseTheme");var l=$(".chooseTheme").attr("code");$("#tableChartPanel").empty();$("#layout_body_title_panel").empty().append('<div class="layout_title_panel full" style="padding-left:22px"><div style="position: absolute;"><span id="filterPanelTag" class="hide">筛选条件</span><span id="containerTag">图形区域</span></div><div id="closeFilter" class="closeFilter hide"><div class="fa fa-caret-up cursor-pointer optIcon"></div> </div> </div>');$("#filterPanel").empty().css({display:"none"}).append('<table> <tr><td class="attr"> <div class="filter-panel"></div></td><td class="search"><i class="fa fa-search"></i></td> </tr>  </table>');$("#centerPanel").css({top:"0px"});g.control.ajaxCharts(l);setTimeout(function(){console.log($("#centerPanel").css("top")!="0px");if($("#centerPanel").css("top")!="0px"){$("#filterPanel").show()}},300)}});var j=$(".chooseTheme").attr("code");if(previewKey){var i=$.evalJSON(window.sessionStorage.getItem(previewKey));if(!i){alert("链接已失效");return}b.main.dataId=i.dataId;b.main.reportName=i.reportName;b.main.reportId=i.reportId;b.main.allowComment=0;c.init();jQuery("#layout_body_title_panel").hide();e.init();var k=$.evalJSON(i.resportConfig);e.start("render",k);return}if(j){g.control.ajaxCharts(j)}},ajaxCharts:function(h){$.ajax({type:"POST",url:d.handleUrlParam("/platform/dataview/queryViewInfo"),dataType:"json",async:false,data:{reportId:h},success:function(j){if(j.dataDeletaFlag==0){alert("数据源已删除！")}b.main.dataId=j.dataId;b.main.reportName=j.reportName;b.main.reportId=j.reportId;b.main.allowComment=j.allowComment;if($.evalJSON(j.urlMenuInfo).length>0){b.main.urlMenuInfo=$.evalJSON(j.urlMenuInfo)}var l=$.evalJSON(j.resportConfig);var k=l.filters;var i=(k&&k.length>0);c.setShareLayout(i);c.init();jQuery("#layout_body_title_panel").hide();e.init();e.start("render",l);$("#shareAndDownload").remove();$("#commentIframe").css({visibility:"hidden"});$("#layout_body_panel").css({position:"relative"});$("#tableChartPanel").css({top:"30px"});$("#layout_body_content_panel").css({"margin-top":"28px"});$("#headName span").click(function(){window.parent.document.getElementById("penetrateShow").style.display="none"});$(".tools").hide()},error:function(){alert(JSON.stringify(arguments));alert("没有查询到数据源，自动跳转到可视化新建页面")}})}};g.module={};g.view={};return g.control});