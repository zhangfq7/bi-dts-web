define(["view/box","bace"],function(a,c){var b={};b.module={type:{"1":"文件导入","2":"数据表","3":"工作表链接","4":"openApi","5":"数据库直连","6":"DACP","7":"视图"}};b.control={show:function(d){if(!jQuery("#dataInfoPanel").length){jQuery("body").append("<div id='dataInfoPanel' style='display:none'></div>");var e=c.handleUrlParam("/platform/dataview/dataInfoPage");jQuery("#dataInfoPanel").load(e,function(){b.view.show(d)})}else{b.view.show(d)}},};b.view={show:function(d){d=d||a.main.dataId;var e=$("#dataInfoPanel");b.view.getDataInfo(d).then(function(f){e.find(".dataName").text(f.dataName);e.find(".dataType").text(b.module.type[f.dataType]);e.find(".dataDesc").text(f.dataDesc);e.find(".adminName").text(f.adminName);e.find(".adminTime").text(f.adminTime);if(f.lastUpdateTime!=null&&f.lastUpdateTime!=""){e.find(".lastUpdateTime").text(f.lastUpdateTime)}else{e.find(".lastUpdateTime").text("无")}var g=f.attrList;$.dialog({title:"数据源信息浏览",padding:"0",width:"800px",height:"500px",lock:true,resizable:false,content:jQuery("#dataInfoPanel")[0],cancelVal:"关闭",cancel:true,init:function(){var h=$("#dataList").ligerGetGridManager();if(h){$.ligerui.remove(h);$("#dataList").remove();jQuery("#dataInfoPanel").append("<div id='dataList' class='bi-gray'></div>")}$("#dataList").ligerGrid({url:c.handleUrlParam("/platform/dataview/preViewDataSrc"),parms:{dataId:d,dataType:f.dataType},columns:function(){var l=[];for(var j=0,k=g.length;j<k;j++){l.push({display:g[j].attrName,name:g[j].attrId,width:110,align:"left"})}return l}(),width:"100%",height:"352px",allowHideColumn:false,enabledSort:false,alternatingRow:false,resizable:false,rownumbers:true,inWindow:false,onLoaded:function(i){c.autoScroll(jQuery("#dataList .l-grid-body2"));jQuery("#dataInfoPanel .dataNum").html(i.currentData.Total)}})}})},function(){})},getDataInfo:function(d){return $.ajax({type:"post",dataType:"json",url:c.handleUrlParam("/platform/dataview/viewDataSrcInfo"),data:{dataId:d||a.main.dataId}})},bindEvent:function(){}};return b.control});