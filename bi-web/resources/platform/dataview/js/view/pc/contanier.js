define(["bace","view/box","view/layout","view/pc/serach","view/widgets/property","view/widgets/plugins/table/table","view/widgets/plugins/echarts/echarts","view/widgets/plugins/text/text","view/widgets/plugins/indicator/indicator","view/eventBinder"],function(c,h,j,d,i,f,b,e){var g={currentPlugin:""};g.module={isHaveFilter:false,isHaveOper:false,thumbURLArray:[],thumbLen:null};var a={lines:13,length:7,width:4,radius:10,corners:1,rotate:0,color:"#fff",speed:1,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000};g.control={init:function(){g.view.init();g.view.gotop();h.Widgets.showLoading=g.view.showLoading;h.Widgets.hideLoading=g.view.hideLoading;h.Widgets.showTip=g.view.showTip;h.Widgets.hideTip=g.view.hideTip},getPluginByType:function(k){if(["pie","bar","barMix","line","radar","funnel","gauge","map","treemap","scatter","heatmap","effectScatter","heatmap1"].indexOf(k)>-1){return h.Widgets.plugins.echarts}else{return h.Widgets.plugins[k]}},start:function(w){if(w=="render"){var o=arguments[1];var k=arguments[2]||"";var y=o.widgets;var l=o.filters;var v=$.toJSON(l);d.dataStart(l);if(l&&l.length>0){jQuery("#layout_body_title_panel").show();setTimeout(function(){j.toggleFilterPanel("open")},500);g.module.isHaveFilter=true}for(var p=0,m=y.length;p<m;p++){var r=y[p];var q=r.option;var t=r.layout;var B=q.config.build.dataParams.hasRight;var s=r.menuData;var u=g.view.packageContainer($("#tableChartPanel"),{top:t.top,left:t._left},q.chartType,q.el,B);u.css({width:t._width,height:t.height,"border-width":t["border-width"],"border-color":t["border-color"],background:t.background,"box-shadow":t["box-shadow"],"border-radius":t["border-radius"]}).data("option",q);if(s){u.data("__menuData",s)}(function(n){setTimeout(function(){var C=g.control.getPluginByType(n.chartType).apply(n,true)},500)})(q)}var A=!o.openWaterflag;g.view.unCopy(A);var x=g.view.getLastBottom();if(h.main.urlMenuInfo.length>0){g.view.containerUlrGroup(x)}if(!k){$("#toggle_publicpanel").on("click",function(n){n.stopPropagation();$(".public_container","#public_panel").slideToggle();$(this).find(".fa").toggleClass("fa-caret-up").toggleClass("fa-caret-down")});$("#public_panel .oper_bar").on("click",function(){$("#toggle_publicpanel").click()});$("#public_panel").css({position:"absolute",width:"100%",top:(x+29)+"px"}).appendTo($("#tableChartPanel"));if(h.main.allowComment==1&&$("#commentIframe")[0]){var z=$("#commentIframe");z[0].onload=function(){};z[0].src=c.handleUrlParam("/platform/myreport/comment/report-comment")+"?reportId="+h.main.reportId}else{$("#commentIframe").remove()}setTimeout(function(){if(o.filters.length==0){jQuery("#layout_body_content_panel").addClass("toTop")}$("#public_panel").removeClass("invisible");jQuery("body").removeClass("invisible")},800)}}},bindEmailAndDownload:function(){$("#downloadEx")[0]&&$("#downloadEx").on("click",function(){if(report_config.smsCaptcha==1&&(report_config.mobileNum==""||report_config.mobileNum==null)){window.open(c.handleUrlParam("/platform/sysmanage/safety/bind-mobile-page"));return}$.dialog({title:"下载数据文件",lock:true,resize:true,width:700,height:318,padding:"0px 0px",content:'<iframe id="mainfrm" frameBorder="0" width="100%" border="0" height="100%" src="'+c.handleUrlParam(webpath+"/platform/download/to-download")+'"></iframe>',cancel:function(){return $("#mainfrm")[0].contentWindow.cancel()},ok:function(){var k=$("#mainfrm")[0].contentWindow.sure();if(k.flag){jQuery(".actGotop").hide();var l=$("#tableChartPanel .container");l.each(function(n,m){var p=$(m);var o=p.data("option");if(o.chartType=="table"){p.find("td[field]>div").each(function(){$(this).width($(this).width())})}});if(k.type=="pic"){g.view.downPic()}else{if(k.type=="ppt"){g.view.downPPT()}}}else{return false}}})});jQuery("#EmailEx")[0]&&jQuery("#EmailEx").bind("click",function(){g.view.getThumbURL(function(k){var l=$("<form></form>",{method:"post",action:c.handleUrlParam(webpath+"/platform/dataview/to-email"),target:"_blank",html:"<input name='reportId' value='"+h.main.reportId+"'/><input name='img' value='"+k+"'/>"});$("body").append(l);l.submit();$(l).remove()})})}};g.view={init:function(){g.view.initDroppable();for(var k in g.view.bindEvent){g.view.bindEvent[k]()}},initDroppable:function(){jQuery("#tableChartPanel").droppable({drop:function(k,s){var m=s.helper;var q=$(this);if(!m.hasClass("hp-container")){g.view.updateGridGraph();return}var n=g.view.autoPositionGrid(k,q);var p=m.attr("chartType");m.remove();var o=g.view.packageContainer(q,n,p);g.view.checkContainerOverlap(o);var l=o.siblings("div[id!='gridBg']");if(l.hasClass("container-error")){var r=g.view.getLastBottom(o);o.animate({top:r},500,function(){g.view.updateGridGraph()});setTimeout(function(){l.removeClass("container-error")},500);q.animate({scrollTop:r-21},500)}g.view.updateGridGraph();g.view.installWidgetsDraggableAndResize()}})},packageContainer:function(s,q,r,p,w){var k=p||"container_"+(new Date()).getTime();var t=r.split("-")[0];s.append($("<div></div>",{id:k,chartType:r,"class":u(t),css:{position:"absolute",left:q.left,top:q.top,transform:"translateZ(0)"},html:l(t)}));function u(x){switch(x){case"text":return"container allow editor-container";break;case"indicator":return"container allow indicator-container";break;default:return"container allow"}}function l(x){switch(x){case"text":return'<div class="chart '+x+'"></div>';break;case"indicator":return'<div class="dimAttrSettingPanel" style="display:none"></div><div class="chart"><i class="iconfont icon-'+x+' exp"></i></div>';break;default:return'<div class="tools"></div><div class="breadcrumbs"></div><div class="chainInfo"></div><div class="dimAttrSettingPanel" style="display:none"></div><div class="chart"><i class="iconfont icon-'+x+' exp"></i></div>'}}var v=$("#"+k);g.currentPlugin=g.control.getPluginByType(t);if(!g.currentPlugin){log("没有找到 "+t+" 对应的组件,请检查是否注册组件！")}else{g.currentPlugin.init();var n=(typeof _RSDFGHJJKK)==="undefined"?"preview":"container";var o=v.attr("charttype");if("table-detail"==o){o=0}else{if("table-pivot"==o){o=1}else{o=0}}$(".tools",v).append(g.currentPlugin.contanier.getTools(n,o));if(!w){$("div.tools>div.discovery").remove()}v.find(".tools .chart-icon").poshytip({className:"tip-twitter",showTimeout:100,alignTo:"target",offsetY:-28,offsetX:12,alignX:"left"});var m=$(g.currentPlugin.contanier.settingPanel);$(".dimAttrSettingPanel",v).append(m);c.autoScroll($("#"+k+" .panel"),{cursorcolor:"#5489A9"})}setTimeout(function(){g.view.resizeTempCharts(v)},100);v.data("option",{el:k,isInit:false,chartType:t,config:{plugins:g.currentPlugin.type,build:{},designPanel:{},dataPanel:{}}});return v},updateGridGraph:function(){var p=jQuery("#tableChartPanel");var l=p.get(0).scrollWidth;var m=p.get(0).scrollHeight;var o=p.data("scrollWidth")||p.width();var k=p.data("scrollHeight")||p.height();var n=p.find("#gridBg");if(l>o){l=l+20;n.width(l);p.data("scrollWidth",l)}if(m>k){m=m+20;n.height(m);p.data("scrollHeight",m)}},resizeTempCharts:function(p){var m=p.find(".iconfont.exp"),o=p.width(),k=p.height(),n=m.width(),l=m.height();m.css({transform:"scale("+Math.min((k/200),(o/200))+")",top:function(){return(k-l)/2},left:function(){return(o-n)/2}})},resizeContainer:function(k){g.control.getPluginByType(k.chartType).contanier.resize.reisze(k.el)},getLastBottom:function(l){var k=0;if(l){$("#tableChartPanel .container").not("#"+l.attr("id")).each(function(){var m=$(this).position().top+$(this).parent().scrollTop()+$(this).height()+20;if(k<m){k=m}})}else{$("#tableChartPanel .container").each(function(){var m=$(this).position().top+$(this).parent().scrollTop()+$(this).height()+20;if(k<m){k=m}})}return Math.round(k/20)*20+10},getLastTop:function(m){var k=[];var l=m?jQuery("#tableChartPanel .container").not("#"+m.attr("id")):jQuery("#tableChartPanel .container");l.each(function(){var n=$(this).position().top+$(this).parent().scrollTop()+20;k.push(n)});return Math.min.apply(null,k)},getFirstLeft:function(){var k=[];var l=jQuery("#tableChartPanel .container");l.each(function(){k.push($(this).position().left+$(this).parent().scrollLeft())});return Math.min.apply({},k)},getLastRight:function(m){var l=0;var k=m?jQuery("#tableChartPanel .container").not("#"+m.attr("id")):jQuery("#tableChartPanel .container");k.each(function(){var n=$(this).position().left+$(this).parent().scrollLeft()+$(this).width()+20;if(l<n){l=n}});return Math.round(l/20)*20+10},bindEvent:{togglePanel:function(){jQuery("#layout_body_title_panel  .closeFilter").on("click",function(){myLayout.center.children.layout1.center.children.layout1.toggle("north");jQuery(this).find("div:eq(0)").toggleClass("fa-caret-up").toggleClass("fa-caret-down")})},contanierTools:function(){$("#download").on("click",function(){if(report_config.smsCaptcha==1&&(report_config.mobileNum==""||report_config.mobileNum==null)){window.open(c.handleUrlParam("/platform/sysmanage/safety/bind-mobile-page"));return}$.dialog({title:"下载数据文件",lock:true,resize:true,width:700,height:318,padding:"0px 0px",content:'<iframe id="mainfrm" frameBorder="0" width="100%" border="0" height="100%" src="'+c.handleUrlParam(webpath+"/platform/download/to-download")+'"></iframe>',cancel:function(){return $("#mainfrm")[0].contentWindow.cancel()},ok:function(){var k=$("#mainfrm")[0].contentWindow.sure();if(k.flag){jQuery(".actGotop").hide();var l=$("#tableChartPanel .container");l.each(function(n,m){var p=$(m);var o=p.data("option");if(o.chartType=="table"){p.find("td[field]>div").each(function(){$(this).width($(this).width())})}});if(k.type=="pic"){g.view.downPic()}else{if(k.type=="ppt"){g.view.downPPT()}}}else{return false}}})});jQuery("#Email").bind("click",function(){g.view.getThumbURL(function(k){var l=$("<form></form>",{method:"post",action:c.handleUrlParam(webpath+"/platform/dataview/to-email"),target:"_blank",html:"<input name='reportId' value='"+h.main.reportId+"'/><input name='img' value='"+k+"'/>"});$("body").append(l);l.submit();$(l).remove()})});jQuery("#tableChartPanel").on("click",".container .chart,.container .panel.datagrid",function(){var k=jQuery(this);var l=k.parents(".container");var m=l.find(".dimAttrSettingPanel");if(m.is(":visible")){m.hide("slide")}});jQuery("#tableChartPanel").on("click",".chart-icon.openSelfDimAttr",function(){var l=jQuery(this).parents(".container");var k=l.data("option").chartType;var m=g.control.getPluginByType(k).contanier.renderSettingPanel(l);if(m.is(":hidden")){m.show("slide")}else{m.hide("slide")}});jQuery("#tableChartPanel").on("click",".chart-icon.discovery",function(){var k=_RSDFGHJJKK;var m=jQuery(this).parents(".container").data("option");var l=m.el;window.open(c.handleUrlParam("/platform/dataview/edit")+"?reportId="+k+"&chartId="+l)});jQuery("#tableChartPanel").on("click",".chart-icon.tabledownload",function(){var l=jQuery(this).parents(".container").data("option");if(!l.isInit){return}var k=c.handleUrlParam("/platform/dataview/down-table-data");k=k+"?"+$.param(l.config.build.dataParams);c.downloadbyfloor(k)});jQuery("#tableChartPanel").on("click",".chart-icon.xy2yx",function(){var l=jQuery(this).parents(".container").data("option");if(l.isInit){var k=JSON.parse(l.config.build.dataParams.dimAttrJsonStr);var m=k.rowsData;k.rowsData=k.colsData;k.colsData=m;m=null;l.config.build.dataParams.dimAttrJsonStr=JSON.stringify(k);g.control.getPluginByType(l.chartType).apply(l,true);$(this).toggleClass("checked")}});jQuery("#tableChartPanel").on("click",".breadcrumbs>a",function(){var m=jQuery(this).parent(".breadcrumbs").find("a").index(this);var k=jQuery(this).parents(".container");var l=k.find(".chart")[0];jQuery(l).EBuilder("undrill",m)});jQuery("#tableChartPanel").on("click",".chainInfo .j_unchainChart",function(){var k=jQuery(this).parents(".container");if(k.find(".chart:visible").length){var l=k.find(".chart")[0];jQuery(l).EBuilder("unchainChart")}else{h.Widgets.plugins.table.unchainChart(k)}})}},showLoading:function(l){if(typeof(Spinner2)!=="undefined"){var k=jQuery("<div></div>",{"class":"bi-confirm loadingBg"});l.spin(a);l.append(k)}l.data("isLoading",true)},hideLoading:function(l){var k=l.find(".loadingBg");if(k.length==0){return}if(typeof(Spinner2)!=="undefined"){l.spin("close");k.remove()}l.data("isLoading",false)},showTip:function(m,l){m.titleShow=m.titleShow||true;var k='<div id="org.bi:bi-web:war:1.0.0-SNAPSHOT" failType="${failType}" class="bi-confirm ${className}">	<div class="confrim-text" style="letter-spacing: 1px;text-align:center">  {{if titleShow==true}} <span style="font-size: 26px;">提示 </span>{{/if}}<br/>{{html msg}}	</div>	<div class="btn-group">{{html button}}	</div></div>';$.tmpl(k,m).appendTo(l)},hideTip:function(k){jQuery("#"+k).remove()},downPic:function(){jQuery("body").append(jQuery("<div>",{"class":"screenClass screenCapture ",html:""}));setTimeout(function(){jQuery(".screenClass").removeClass("screenCapture").addClass("screen-img");setTimeout(function(){jQuery("#layout_body_panel .closeFilter,#filterPanel .search").hide();jQuery(".screenClass").append(jQuery("<div>",{"class":"load",html:'<img src="data:image/png;base64,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">'}));g.view.getThumbURL(function(k){jQuery("#layout_body_panel .closeFilter,#filterPanel .search").show();jQuery("#downPic,.screenClass").remove();var m=h.main.reportId;var o=h.main.reportName;var l=k;jQuery("<form>",{id:"downPic",method:"post",action:c.handleUrlParam("/platform/dataview/downImageFile"),target:"_self",html:"<input name='reportId' type='hidden' value='"+m+"'/><input name='fileName' type='hidden' value='"+o+"'/><input name='imgBaseStr' type='hidden' value='"+l+"'/>"}).appendTo("body");jQuery("#downPic").submit();var n=$("#tableChartPanel .container");n.each(function(q,p){var s=$(p);var r=s.data("option");if(r.chartType=="table"){s.find("td[field]>div").each(function(){$(this)[0].style.width=""})}})})},2000)},600)},getThumbURL:function(p){var o=jQuery("#tableChartPanel");jQuery("#thumb_canvas").remove();var m=[];jQuery("#tableChartPanel .container").each(function(){var q=$(this);m.push((q.position().top>0?q.position().top:q.parent().scrollTop()+q.position().top)+q.height()+10)});var n=Math.max.apply({},m)+10;var l=jQuery("#filterPanel").height()+jQuery("#layout_body_title_panel").height()+jQuery(".share-panel").height()+1;var k=jQuery("body").width();if(!(g.module.isHaveFilter&&jQuery("#filterPanel").css("display")!="none")){l=50}html2canvas(document.getElementById("tableChartPanel"),{proxy:webpath+"/ImageServlet",onrendered:function(q){var t=0;var r=l;var s=new Image();s.src=q.toDataURL("image/png");s.onload=function(){var w=k;var u=n+l;var y=document.createElement("canvas");y.setAttribute("id","thumb_canvas");y.style.display="none";y.width=w;y.height=u;document.body.appendChild(y);var x=document.getElementById("thumb_canvas");var v=x.getContext("2d");v.drawImage(s,t,r);jQuery(".screenClass").remove();if((g.module.isHaveFilter&&jQuery("#filterPanel").css("display")!="none")){html2canvas(document.body,{onrendered:function(z){var A=new Image();A.src=z.toDataURL("image/png");v.drawImage(A,t,0);setTimeout(function(){p(x.toDataURL("image/png"))},200)},width:k,height:l})}else{if(jQuery(".share-panel").length>0){html2canvas(document.body,{onrendered:function(z){var A=new Image();A.src=z.toDataURL("image/png");v.drawImage(A,t,0);setTimeout(function(){p(x.toDataURL("image/png"))},200)},width:k,height:l})}else{p(x.toDataURL("image/png"))}}}},width:k,height:n+l})},downPPT:function(){jQuery("body").append(jQuery("<div>",{"class":"screenClass screenCapture ",html:""}));setTimeout(function(){jQuery(".screenClass").removeClass("screenCapture").addClass("screen-img");setTimeout(function(){jQuery("#layout_body_panel .closeFilter,#filterPanel .search").hide();jQuery(".screenClass").append(jQuery("<div>",{"class":"load",html:'<img src="data:image/png;base64,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">'}));g.view.getThumbURL(function(l){var m=$("#tableChartPanel .container");var k=[];jQuery("#layout_body_panel .closeFilter,#filterPanel .search").show();jQuery(".screenClass").remove();m.each(function(w,B){var A=$(B);jQuery("#pptCanvas").remove();var x=A.data("option");if(x.chartType=="table"){var y=document.createElement("canvas");y.setAttribute("id","pptCanvas");y.style.display="none";y.width=A.outerWidth();y.height=A.outerHeight(true);document.body.appendChild(y);var t=document.getElementById("pptCanvas");var q=t.getContext("2d");var s=new Image();var p=parseInt(A.css("top").replace("px",""));var z=jQuery(".filter-panel");var o=z.height();var u=z.css("min-height").replace("px","");if(o==0){p=p+50}else{p=p+130+(o-u)}var r=A.offset().left;s.onload=function(){q.drawImage(s,r,p,A.outerWidth(),A.outerHeight(true),0,0,A.outerWidth(),A.outerHeight(true));k.push(t.toDataURL("image/png"))};s.src=l}else{k.push($(".chart",A).EBuilder("getInstanceByDom").getDataURL({backgroundColor:A.css("backgroundColor")}))}});var n=setInterval(function(){q=$("#tableChartPanel .container");if(k.length!=0&&k.length==q.length){var o=k.join("&&");jQuery("#downPPT").remove();var p=h.main.reportId;var r=h.main.reportName;jQuery("<form>",{id:"downPPT",method:"post",action:c.handleUrlParam("/platform/dataview/download-ppt-file"),target:"_self",html:"<input name='reportId' type='hidden' value='"+p+"'/><input name='fileName' type='hidden' value='"+r+"'/><input name='pptStr' type='hidden' value='"+o.toString()+"'/>"}).appendTo("body");jQuery("#downPPT").submit();clearInterval(n);var q=$("#tableChartPanel .container");q.each(function(t,s){var w=$(s);var u=w.data("option");if(u.chartType=="table"){w.find("td[field]>div").each(function(){$(this)[0].style.width=""})}})}},500)})},2000)},600)},gotop:function(){var k=jQuery("#tableChartPanel");k.scroll(function(){if(k.scrollTop()>=100){jQuery(".actGotop").fadeIn(300);jQuery(".report-panel").addClass("suspension")}else{if(k.scrollTop()<90){jQuery(".actGotop").fadeOut(300);jQuery(".report-panel").removeClass("suspension")}}});jQuery(".actGotop").click(function(){k.animate({scrollTop:"0px"},800)})},unCopy:function(l){if(report_config.copyFlag==1){jQuery(document).bind("contextmenu",function(m){return false});jQuery(document).bind("copy",function(m){return false})}if(report_config.waterFlag==1&&l){var k=g.view.getLastBottom();jQuery("#tableChartPanel").append(jQuery("<div>",{id:"water",css:{position:"absolute",width:"100%",top:"0",height:k+"px",background:"url("+webpath+"/WaterImageServlet)",opacity:".3","z-index":"-1"}}))}},containerUlrGroup:function(n){$("#tableChartPanel").append('<div id="layout_body_url_panel" class="container-url" style="background:rgb(248, 252, 255);position:absolute;top:'+n+'px"><div id="urlPanel" class=" urlpaths_name_left"></div></div>');var o="data:image/png;base64,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";var l=$("#urlPanel");var q;var r=h.main.urlMenuInfo.length;var p=h.main.urlMenuInfo[r-1].position;var m="";var s=[];var k=0;$.map(h.main.urlMenuInfo,function(t){if(t.reportUrlInfo){if(t.reportUrlInfo.length!=0){m+='<div class="urlPaths"><div class="urlpaths_name urlnamedefine_'+(++k)+'"><b class="fa fa-bars url_fa"></b><a>'+t.menuName+'</a></div><ul class="urlmenus">';$.map(t.reportUrlInfo,function(u){m+='<li class="urlmenulist"><a href="'+u.urlPathDetail+'" target="_blank"><img class="urlpicture" src="'+(u.urlPathPicture||o)+'">'+u.urlPathName+"</a></li>"});m+="</ul></div>"}else{m+='<div class="urlPaths"><div class="urlpaths_name urlnamedefine_'+(++k)+'"><b class="fa fa-bars url_fa"></b><a>'+t.menuName+"</a></div></div>"}}s.push(m);m=""});l.append(s.join(""));if(p==="middle"){q=100/(r-1);$("#urlPanel>div.urlPaths").css("width",q+"%")}else{if(p=="right"){l.removeClass("urlpaths_name_left").addClass("urlpaths_name_"+p);$("#urlPanel>div.urlPaths").css({"float":"right",borderRight:"none",borderLeft:"1px solid #ddd"})}}$("#urlPanel").on("click",".urlpaths_name>a",function(t){$(t.target).parent().siblings().toggleClass("active")});$("body").click(function(u){var t=$(u.target);if(!(t.parent().hasClass("urlpaths_name"))){$("#urlPanel ul.urlmenus.active").removeClass("active")}})}};return g.control});