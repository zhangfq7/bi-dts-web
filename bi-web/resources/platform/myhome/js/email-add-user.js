define(["sabace"],function(c){function e(){jQuery(".chosen-select").chosen({disable_search:true});jQuery(".userList").on("click","a",function(){var f=jQuery(this).find("input[data-toggle='checkbox']");f.prop("checked",!f.prop("checked"))});d(jQuery(".sys"),"sys");jQuery(".searchBtn").bind("click",function(){jQuery("#sysuserTable").jqGrid("setGridParam",{postData:{userName:jQuery("#userName").val(),userId:jQuery("#userId").val(),sex:jQuery(".chosen-select").val()}}).trigger("reloadGrid",[{page:1}])});jQuery(".sys .right").bind("click",function(){var k=jQuery("#sysuserTable").jqGrid("getGridParam","selarrrow");if(k.length==0){bi.dialog.show({title:c.getMessage("home.label.TipBox"),message:c.getMessage("report.share.check"),cssClass:"register-dialog",nl2br:false,closable:true,closeByBackdrop:false,closeByKeyboard:false,buttons:[{label:c.getMessage("home.button.sure"),action:function(i){i.close()}}]});return}jQuery(".sys .ui-jqgrid-bdiv>div").show();jQuery(".sys .ui-jqgrid-bdiv .noResult").hide();var h=jQuery("#sysshareuserTable").jqGrid("getDataIDs");var l=0;if(h.length>0){l=h[h.length-1]}var f=k.length;for(var g=0;g<f;g++){var j=jQuery("#sysuserTable").jqGrid("getRowData",k[0]);jQuery("#sysshareuserTable").jqGrid("addRowData",Number(l)+g+1,j);jQuery("#sysuserTable").jqGrid("delRowData",k[0])}});jQuery(".sys .left").bind("click",function(){var k=jQuery("#sysshareuserTable").jqGrid("getGridParam","selarrrow");if(k.length==0){bi.dialog.show({title:c.getMessage("home.label.TipBox"),message:c.getMessage("report.share.check"),cssClass:"register-dialog",nl2br:false,closable:true,closeByBackdrop:false,closeByKeyboard:false,buttons:[{label:c.getMessage("home.button.sure"),action:function(i){i.close()}}]});return}var h=jQuery("#sysuserTable").jqGrid("getDataIDs");var l=0;if(h.length>0){l=h[h.length-1]}var f=k.length;for(var g=0;g<f;g++){var j=jQuery("#sysshareuserTable").jqGrid("getRowData",k[0]);jQuery("#sysuserTable").jqGrid("addRowData",Number(l)+g+1,j);jQuery("#sysshareuserTable").jqGrid("delRowData",k[0])}})}function b(f,g){f.find(".selectList").html('<table id="'+g+'userTable"></table>');f.find("#"+g+"userTable").jqGrid({url:c.handleUrlParam("/platform/myreport/manage/user-list")+"?type=2",datatype:"json",loadComplete:function(p){var o=jQuery("."+g).find("#"+g+"shareuserTable");var h=jQuery("."+g).find("#"+g+"userTable");var n=o.jqGrid("getRowData");var m=h.getCol("userID",true);for(var l=0;l<n.length;l++){for(var k=0;k<m.length;k++){if(m[k].value==n[l].userID){h.jqGrid("delRowData",m[k].id)}}}jQuery(".number").html(p.length)},styleUI:"Bootstrap",colModel:[{label:"用户编码",width:75,name:"userID",align:"center"},{label:"邮箱",width:130,name:"email",align:"center",sortable:false}],shrinkToFit:false,width:290,height:300,viewrecords:true,multiselect:true,loadtext:"",rowNum:100000,rownumbers:true,regional:"cn"})}function d(f,g){f.find(".selectedList").html('<table id="'+g+'shareuserTable"></table>');f.find("#"+g+"shareuserTable").jqGrid({url:c.handleUrlParam("/platform/myreport/manage/share-user-list"),datatype:"json",loadComplete:function(h){b(jQuery("."+g),g);if(h.length>0){jQuery("."+g).find(".selectedList").find(".ui-jqgrid-bdiv>div").css("border-left","none")}else{jQuery("."+g).find(".selectedList").find(".ui-jqgrid-bdiv>div").css("border-left","1px solid #ddd")}},styleUI:"Bootstrap",colModel:[{label:"用户编码",width:75,name:"userID",align:"center"},{label:"邮箱",width:130,name:"email",align:"center",sortable:false}],shrinkToFit:false,width:290,height:300,viewrecords:true,multiselect:true,loadtext:"",rowNum:100000,rownumbers:true,jsonReader:{records:"total",total:"totalPages"},regional:"cn"})}function a(){var f=jQuery("#sysshareuserTable").jqGrid("getRowData");jQuery("#userList").html("");var g=$("#sendEmail").val();jQuery.each(f,function(j,h){if(h.email==""){return}g+=(","+h.email)});$("#sendEmail").tagsinput("add",g)}return{init:e,saveUsers:a}});